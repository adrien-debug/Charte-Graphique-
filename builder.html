<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Design System Builder — IPO-Ready</title>
  <link rel="stylesheet" href="ds.css" />
  <style>
    body { margin: 0; padding: 0; overflow: hidden; }

    /* Layout builder */
    .builder {
      display: grid;
      grid-template-columns: 380px 1fr;
      grid-template-rows: 64px 1fr;
      height: 100vh;
    }

    /* Header */
    .builder-header {
      grid-column: 1 / -1;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 var(--ds-space-6);
      background: var(--ds-bg-surface-1);
      border-bottom: 1px solid var(--ds-border-default);
    }
    .builder-header__title {
      font-size: 18px;
      font-weight: 700;
    }
    .builder-header__actions {
      display: flex;
      gap: 12px;
    }

    /* Sidebar (steps) */
    .builder-sidebar {
      display: flex;
      flex-direction: column;
      background: var(--ds-bg-surface-1);
      border-right: 1px solid var(--ds-border-default);
      overflow-y: auto;
    }

    /* Stepper */
    .stepper {
      padding: var(--ds-space-6);
    }
    .step {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 16px;
      margin-bottom: 8px;
      border-radius: var(--ds-radius-3);
      border: 1px solid var(--ds-border-subtle);
      background: var(--ds-bg-canvas);
      cursor: pointer;
      transition: background var(--ds-dur-fast), border-color var(--ds-dur-fast);
    }
    .step:hover {
      background: var(--ds-bg-surface-2);
      border-color: var(--ds-border-default);
    }
    .step.is-active {
      background: rgba(24,169,87,0.12);
      border-color: var(--ds-green-500);
    }
    .step.is-done {
      background: var(--ds-bg-surface-2);
      border-left: 3px solid var(--ds-green-500);
    }
    .step__number {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--ds-bg-surface-3);
      color: var(--ds-text-tertiary);
      font-size: 13px;
      font-weight: 700;
      flex-shrink: 0;
    }
    .step.is-active .step__number {
      background: var(--ds-green-500);
      color: var(--ds-bg-canvas);
    }
    .step.is-done .step__number {
      background: var(--ds-green-700);
      color: var(--ds-text-primary);
    }
    .step__content {
      flex: 1;
    }
    .step__title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 4px;
    }
    .step__desc {
      font-size: 12px;
      color: var(--ds-text-tertiary);
      line-height: 1.4;
    }

    /* Preview area */
    .builder-preview {
      display: flex;
      flex-direction: column;
      background: var(--ds-bg-canvas);
      overflow: hidden;
    }

    /* Preview toolbar */
    .preview-toolbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px var(--ds-space-6);
      background: var(--ds-bg-surface-1);
      border-bottom: 1px solid var(--ds-border-subtle);
    }
    .preview-toolbar__label {
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: var(--ds-text-tertiary);
    }
    .preview-toolbar__modes {
      display: flex;
      gap: 8px;
    }
    .mode-btn {
      padding: 6px 12px;
      border-radius: 6px;
      border: 1px solid var(--ds-border-subtle);
      background: var(--ds-bg-canvas);
      color: var(--ds-text-secondary);
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: background var(--ds-dur-fast), border-color var(--ds-dur-fast);
    }
    .mode-btn:hover {
      background: var(--ds-bg-surface-2);
    }
    .mode-btn.is-active {
      background: var(--ds-green-700);
      border-color: var(--ds-green-700);
      color: var(--ds-text-primary);
    }

    /* Preview content */
    .preview-content {
      flex: 1;
      overflow-y: auto;
      padding: var(--ds-space-8);
    }

    /* Panel de configuration */
    .config-panel {
      padding: var(--ds-space-6);
      border-top: 1px solid var(--ds-border-subtle);
    }
    .config-panel__title {
      margin-bottom: var(--ds-space-4);
      font-size: 14px;
      font-weight: 600;
      color: var(--ds-text-secondary);
    }
    .config-group {
      margin-bottom: var(--ds-space-6);
    }
    .config-label {
      display: block;
      margin-bottom: 8px;
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: var(--ds-text-tertiary);
    }

    /* Options sélection */
    .option-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 8px;
    }
    .option-card {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      border-radius: var(--ds-radius-2);
      border: 1px solid var(--ds-border-subtle);
      background: var(--ds-bg-canvas);
      cursor: pointer;
      transition: background var(--ds-dur-fast), border-color var(--ds-dur-fast);
    }
    .option-card:hover {
      background: var(--ds-bg-surface-2);
      border-color: var(--ds-border-default);
    }
    .option-card.is-selected {
      background: rgba(24,169,87,0.12);
      border-color: var(--ds-green-500);
    }
    .option-card__radio {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      border: 2px solid var(--ds-border-default);
      background: var(--ds-bg-canvas);
      flex-shrink: 0;
      transition: background var(--ds-dur-fast), border-color var(--ds-dur-fast);
    }
    .option-card.is-selected .option-card__radio {
      background: var(--ds-green-500);
      border-color: var(--ds-green-500);
      box-shadow: inset 0 0 0 3px var(--ds-bg-canvas);
    }
    .option-card__content {
      flex: 1;
    }
    .option-card__title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 4px;
    }
    .option-card__desc {
      font-size: 12px;
      color: var(--ds-text-tertiary);
      line-height: 1.4;
    }

    /* Color swatches */
    .swatch-preview {
      display: flex;
      gap: 4px;
      margin-top: 8px;
    }
    .swatch-preview__item {
      width: 24px;
      height: 24px;
      border-radius: 4px;
      border: 1px solid var(--ds-border-subtle);
    }

    /* Navigation buttons */
    .step-nav {
      display: flex;
      gap: 12px;
      padding: var(--ds-space-6);
      border-top: 1px solid var(--ds-border-subtle);
      background: var(--ds-bg-surface-1);
    }
    .step-nav__btn {
      flex: 1;
    }

    /* Preview modes */
    .preview-mode {
      display: none;
    }
    .preview-mode.is-active {
      display: block;
    }

    /* Demo sections in preview */
    .demo-section {
      margin-bottom: var(--ds-space-10);
    }
    .demo-section__title {
      margin-bottom: var(--ds-space-6);
      padding-bottom: var(--ds-space-3);
      border-bottom: 1px solid var(--ds-border-subtle);
      font-size: 24px;
    }

    /* Responsive */
    @media (max-width: 1024px) {
      .builder {
        grid-template-columns: 1fr;
        grid-template-rows: 64px auto 1fr;
      }
      .builder-sidebar {
        border-right: none;
        border-bottom: 1px solid var(--ds-border-default);
      }
    }
  </style>
</head>

<body>
  <div class="builder">
    <!-- Header -->
    <header class="builder-header">
      <div class="builder-header__title">
        Design System Builder
        <span class="ds-micro" style="color:var(--ds-text-tertiary); margin-left:12px;">IPO-READY</span>
      </div>
      <div class="builder-header__actions">
        <button class="ds-btn ds-btn--secondary" onclick="resetBuilder()">Reset</button>
        <button class="ds-btn ds-btn--primary" onclick="exportDesign()">Export →</button>
      </div>
    </header>

    <!-- Sidebar (Steps) -->
    <aside class="builder-sidebar">
      <div class="stepper">
        <div class="step is-active" data-step="1" onclick="goToStep(1)">
          <div class="step__number">1</div>
          <div class="step__content">
            <div class="step__title">Couleurs</div>
            <div class="step__desc">Palette dark/light + accents</div>
          </div>
        </div>

        <div class="step" data-step="2" onclick="goToStep(2)">
          <div class="step__number">2</div>
          <div class="step__content">
            <div class="step__title">Typographie</div>
            <div class="step__desc">Familles + échelle</div>
          </div>
        </div>

        <div class="step" data-step="3" onclick="goToStep(3)">
          <div class="step__number">3</div>
          <div class="step__content">
            <div class="step__title">Layout</div>
            <div class="step__desc">Grilles + espacements</div>
          </div>
        </div>

        <div class="step" data-step="4" onclick="goToStep(4)">
          <div class="step__number">4</div>
          <div class="step__content">
            <div class="step__title">Composants</div>
            <div class="step__desc">Buttons, cards, KPI, tables</div>
          </div>
        </div>

        <div class="step" data-step="5" onclick="goToStep(5)">
          <div class="step__number">5</div>
          <div class="step__content">
            <div class="step__title">Hero</div>
            <div class="step__desc">Style typographique hero</div>
          </div>
        </div>

        <div class="step" data-step="6" onclick="goToStep(6)">
          <div class="step__number">6</div>
          <div class="step__content">
            <div class="step__title">Export</div>
            <div class="step__desc">Télécharger le design</div>
          </div>
        </div>
      </div>

      <!-- Config panel (changes per step) -->
      <div class="config-panel" id="configPanel">
        <!-- Dynamic content loaded here -->
      </div>

      <!-- Navigation -->
      <div class="step-nav">
        <button class="ds-btn ds-btn--secondary step-nav__btn" id="btnPrev" onclick="prevStep()">← Précédent</button>
        <button class="ds-btn ds-btn--primary step-nav__btn" id="btnNext" onclick="nextStep()">Suivant →</button>
      </div>
    </aside>

    <!-- Preview area -->
    <main class="builder-preview">
      <div class="preview-toolbar">
        <div class="preview-toolbar__label">Preview</div>
        <div class="preview-toolbar__modes">
          <button class="mode-btn is-active" data-mode="desktop" onclick="setPreviewMode('desktop')">Desktop</button>
          <button class="mode-btn" data-mode="tablet" onclick="setPreviewMode('tablet')">Tablet</button>
          <button class="mode-btn" data-mode="mobile" onclick="setPreviewMode('mobile')">Mobile</button>
        </div>
      </div>

      <div class="preview-content" id="previewContent">
        <!-- Dynamic preview loaded here -->
      </div>
    </main>
  </div>

  <script>
    // === STATE ===
    let currentStep = 1;
    const config = {
      colors: 'dark-default',
      typography: 'inter-mono',
      layout: 'grid-12',
      components: 'full',
      hero: 'outline-a'
    };

    // === INIT ===
    document.addEventListener('DOMContentLoaded', () => {
      loadConfig();
      renderStep(currentStep);
      updatePreview();
    });

    // === NAVIGATION ===
    function goToStep(step) {
      if (step < 1 || step > 6) return;
      currentStep = step;
      renderStep(step);
      updateStepperUI();
    }

    function nextStep() {
      if (currentStep < 6) {
        markStepDone(currentStep);
        goToStep(currentStep + 1);
      }
    }

    function prevStep() {
      if (currentStep > 1) {
        goToStep(currentStep - 1);
      }
    }

    function updateStepperUI() {
      document.querySelectorAll('.step').forEach(step => {
        const stepNum = parseInt(step.dataset.step);
        step.classList.remove('is-active');
        if (stepNum === currentStep) {
          step.classList.add('is-active');
        }
      });

      // Update nav buttons
      document.getElementById('btnPrev').disabled = currentStep === 1;
      document.getElementById('btnNext').textContent = currentStep === 6 ? 'Terminer' : 'Suivant →';
    }

    function markStepDone(step) {
      const stepEl = document.querySelector(`.step[data-step="${step}"]`);
      if (stepEl) {
        stepEl.classList.add('is-done');
      }
    }

    // === RENDER STEP CONFIG ===
    function renderStep(step) {
      const panel = document.getElementById('configPanel');
      
      switch(step) {
        case 1:
          panel.innerHTML = renderColorStep();
          break;
        case 2:
          panel.innerHTML = renderTypographyStep();
          break;
        case 3:
          panel.innerHTML = renderLayoutStep();
          break;
        case 4:
          panel.innerHTML = renderComponentsStep();
          break;
        case 5:
          panel.innerHTML = renderHeroStep();
          break;
        case 6:
          panel.innerHTML = renderExportStep();
          break;
      }
      
      updatePreview();
    }

    // === STEP 1: COLORS ===
    function renderColorStep() {
      return `
        <div class="config-panel__title">Sélectionnez votre palette</div>
        
        <div class="option-grid">
          <div class="option-card ${config.colors === 'dark-default' ? 'is-selected' : ''}" onclick="selectColor('dark-default')">
            <div class="option-card__radio"></div>
            <div class="option-card__content">
              <div class="option-card__title">Dark Default (recommandé)</div>
              <div class="option-card__desc">Noir profond + gris industriels + verts techno</div>
              <div class="swatch-preview">
                <div class="swatch-preview__item" style="background:#0B0D0E;"></div>
                <div class="swatch-preview__item" style="background:#121518;"></div>
                <div class="swatch-preview__item" style="background:#18A957;"></div>
                <div class="swatch-preview__item" style="background:#F6F7F8;"></div>
              </div>
            </div>
          </div>

          <div class="option-card ${config.colors === 'dark-blue' ? 'is-selected' : ''}" onclick="selectColor('dark-blue')">
            <div class="option-card__radio"></div>
            <div class="option-card__content">
              <div class="option-card__title">Dark Blue</div>
              <div class="option-card__desc">Bleu nuit + gris froids + accents cyan</div>
              <div class="swatch-preview">
                <div class="swatch-preview__item" style="background:#0A0E17;"></div>
                <div class="swatch-preview__item" style="background:#131820;"></div>
                <div class="swatch-preview__item" style="background:#22A7F0;"></div>
                <div class="swatch-preview__item" style="background:#F6F7F8;"></div>
              </div>
            </div>
          </div>

          <div class="option-card ${config.colors === 'dark-warm' ? 'is-selected' : ''}" onclick="selectColor('dark-warm')">
            <div class="option-card__radio"></div>
            <div class="option-card__content">
              <div class="option-card__title">Dark Warm</div>
              <div class="option-card__desc">Noir chaud + bruns + accents ambre</div>
              <div class="swatch-preview">
                <div class="swatch-preview__item" style="background:#0E0C0B;"></div>
                <div class="swatch-preview__item" style="background:#1A1714;"></div>
                <div class="swatch-preview__item" style="background:#D4A574;"></div>
                <div class="swatch-preview__item" style="background:#F6F7F8;"></div>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function selectColor(palette) {
      config.colors = palette;
      saveConfig();
      renderStep(1);
      updatePreview();
    }

    // === STEP 2: TYPOGRAPHY ===
    function renderTypographyStep() {
      return `
        <div class="config-panel__title">Sélectionnez vos polices</div>
        
        <div class="option-grid">
          <div class="option-card ${config.typography === 'inter-mono' ? 'is-selected' : ''}" onclick="selectTypography('inter-mono')">
            <div class="option-card__radio"></div>
            <div class="option-card__content">
              <div class="option-card__title">Inter + IBM Plex Mono (recommandé)</div>
              <div class="option-card__desc">UI moderne + données financières</div>
            </div>
          </div>

          <div class="option-card ${config.typography === 'roboto-mono' ? 'is-selected' : ''}" onclick="selectTypography('roboto-mono')">
            <div class="option-card__radio"></div>
            <div class="option-card__content">
              <div class="option-card__title">Roboto + Roboto Mono</div>
              <div class="option-card__desc">Google Fonts, très lisible</div>
            </div>
          </div>

          <div class="option-card ${config.typography === 'system' ? 'is-selected' : ''}" onclick="selectTypography('system')">
            <div class="option-card__radio"></div>
            <div class="option-card__content">
              <div class="option-card__title">System fonts</div>
              <div class="option-card__desc">Performance maximale, natif OS</div>
            </div>
          </div>
        </div>
      `;
    }

    function selectTypography(typo) {
      config.typography = typo;
      saveConfig();
      renderStep(2);
      updatePreview();
    }

    // === STEP 3: LAYOUT ===
    function renderLayoutStep() {
      return `
        <div class="config-panel__title">Sélectionnez votre grille</div>
        
        <div class="option-grid">
          <div class="option-card ${config.layout === 'grid-12' ? 'is-selected' : ''}" onclick="selectLayout('grid-12')">
            <div class="option-card__radio"></div>
            <div class="option-card__content">
              <div class="option-card__title">12 colonnes (recommandé)</div>
              <div class="option-card__desc">Desktop 12, Tablet 8, Mobile 4</div>
            </div>
          </div>

          <div class="option-card ${config.layout === 'grid-16' ? 'is-selected' : ''}" onclick="selectLayout('grid-16')">
            <div class="option-card__radio"></div>
            <div class="option-card__content">
              <div class="option-card__title">16 colonnes</div>
              <div class="option-card__desc">Desktop 16, Tablet 8, Mobile 4 (plus fin)</div>
            </div>
          </div>

          <div class="option-card ${config.layout === 'flex' ? 'is-selected' : ''}" onclick="selectLayout('flex')">
            <div class="option-card__radio"></div>
            <div class="option-card__content">
              <div class="option-card__title">Flexbox libre</div>
              <div class="option-card__desc">Pas de grille rigide, flex-wrap</div>
            </div>
          </div>
        </div>
      `;
    }

    function selectLayout(layout) {
      config.layout = layout;
      saveConfig();
      renderStep(3);
      updatePreview();
    }

    // === STEP 4: COMPONENTS ===
    function renderComponentsStep() {
      return `
        <div class="config-panel__title">Sélectionnez vos composants</div>
        
        <div class="option-grid">
          <div class="option-card ${config.components === 'full' ? 'is-selected' : ''}" onclick="selectComponents('full')">
            <div class="option-card__radio"></div>
            <div class="option-card__content">
              <div class="option-card__title">Pack complet (recommandé)</div>
              <div class="option-card__desc">Buttons, cards, KPI, tables, panels</div>
            </div>
          </div>

          <div class="option-card ${config.components === 'minimal' ? 'is-selected' : ''}" onclick="selectComponents('minimal')">
            <div class="option-card__radio"></div>
            <div class="option-card__content">
              <div class="option-card__title">Pack minimal</div>
              <div class="option-card__desc">Buttons, cards uniquement</div>
            </div>
          </div>

          <div class="option-card ${config.components === 'finance' ? 'is-selected' : ''}" onclick="selectComponents('finance')">
            <div class="option-card__radio"></div>
            <div class="option-card__content">
              <div class="option-card__title">Pack finance</div>
              <div class="option-card__desc">Tables, KPI, data panels</div>
            </div>
          </div>
        </div>
      `;
    }

    function selectComponents(comp) {
      config.components = comp;
      saveConfig();
      renderStep(4);
      updatePreview();
    }

    // === STEP 5: HERO ===
    function renderHeroStep() {
      return `
        <div class="config-panel__title">Sélectionnez votre style hero</div>
        
        <div class="option-grid">
          <div class="option-card ${config.hero === 'outline-a' ? 'is-selected' : ''}" onclick="selectHero('outline-a')">
            <div class="option-card__radio"></div>
            <div class="option-card__content">
              <div class="option-card__title">Outline A — Plein + contour</div>
              <div class="option-card__desc">Remplissage texte + stroke 2px (recommandé)</div>
            </div>
          </div>

          <div class="option-card ${config.hero === 'outline-b' ? 'is-selected' : ''}" onclick="selectHero('outline-b')">
            <div class="option-card__radio"></div>
            <div class="option-card__content">
              <div class="option-card__title">Outline B — Creux + contour</div>
              <div class="option-card__desc">Transparent + stroke 2.5px (impact tech)</div>
            </div>
          </div>

          <div class="option-card ${config.hero === 'gradient' ? 'is-selected' : ''}" onclick="selectHero('gradient')">
            <div class="option-card__radio"></div>
            <div class="option-card__content">
              <div class="option-card__title">Dégradé vert</div>
              <div class="option-card__desc">Green → Cyan + outline A</div>
            </div>
          </div>

          <div class="option-card ${config.hero === 'solid' ? 'is-selected' : ''}" onclick="selectHero('solid')">
            <div class="option-card__radio"></div>
            <div class="option-card__content">
              <div class="option-card__title">Solide (sans contour)</div>
              <div class="option-card__desc">Texte blanc simple, pas d'effet</div>
            </div>
          </div>
        </div>
      `;
    }

    function selectHero(hero) {
      config.hero = hero;
      saveConfig();
      renderStep(5);
      updatePreview();
    }

    // === STEP 6: EXPORT ===
    function renderExportStep() {
      return `
        <div class="config-panel__title">Configuration terminée !</div>
        
        <div style="padding:16px; background:rgba(24,169,87,0.12); border-radius:10px; border:1px solid var(--ds-green-500); margin-bottom:16px;">
          <div style="font-size:14px; font-weight:600; margin-bottom:8px;">✅ Design prêt</div>
          <div style="font-size:12px; color:var(--ds-text-secondary); line-height:1.5;">
            Votre design system est configuré. Vous pouvez maintenant l'exporter ou revenir en arrière pour ajuster.
          </div>
        </div>

        <div style="font-size:12px; color:var(--ds-text-tertiary); margin-bottom:8px;">Votre configuration :</div>
        <div style="display:grid; gap:8px; padding:12px; background:var(--ds-bg-canvas); border-radius:6px; border:1px solid var(--ds-border-subtle);">
          <div style="display:flex; justify-content:space-between;">
            <span style="color:var(--ds-text-tertiary); font-size:12px;">Couleurs</span>
            <span style="font-size:12px; font-weight:600;">${config.colors}</span>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span style="color:var(--ds-text-tertiary); font-size:12px;">Typographie</span>
            <span style="font-size:12px; font-weight:600;">${config.typography}</span>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span style="color:var(--ds-text-tertiary); font-size:12px;">Layout</span>
            <span style="font-size:12px; font-weight:600;">${config.layout}</span>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span style="color:var(--ds-text-tertiary); font-size:12px;">Composants</span>
            <span style="font-size:12px; font-weight:600;">${config.components}</span>
          </div>
          <div style="display:flex; justify-content:space-between;">
            <span style="color:var(--ds-text-tertiary); font-size:12px;">Hero</span>
            <span style="font-size:12px; font-weight:600;">${config.hero}</span>
          </div>
        </div>
      `;
    }

    // === UPDATE PREVIEW ===
    function updatePreview() {
      const preview = document.getElementById('previewContent');
      
      // Apply color theme
      applyColorTheme(config.colors);
      
      // Render preview content
      preview.innerHTML = `
        <div class="demo-section">
          <h2 class="demo-section__title">Preview de votre Design System</h2>
          <p style="color:var(--ds-text-secondary); margin-bottom:var(--ds-space-6);">
            Configuration : <strong>${config.colors}</strong> + <strong>${config.typography}</strong> + <strong>${config.layout}</strong>
          </p>

          <!-- Hero preview -->
          <div style="padding:var(--ds-space-10); background:linear-gradient(180deg, rgba(11,13,14,0.55), rgba(11,13,14,0.88)), url('https://images.unsplash.com/photo-1542621334-a254cf47733d?auto=format&fit=crop&w=1200&q=75'); background-size:cover; background-position:center; text-align:center; border-radius:var(--ds-radius-3); margin-bottom:var(--ds-space-8);">
            <div class="ds-pill" style="margin-bottom:18px;">Qatar Vision 2030</div>
            ${renderHeroPreview()}
            <div class="heroSub">100MW Sovereign Mining Facility</div>
          </div>

          <!-- Components preview -->
          ${renderComponentsPreview()}
        </div>
      `;
    }

    function renderHeroPreview() {
      const heroClass = config.hero === 'outline-a' ? 'outlineA' :
                        config.hero === 'outline-b' ? 'outlineB' :
                        config.hero === 'solid' ? '' : 'outlineA gradClip gradGreenCyan';
      
      return `
        <h1 class="heroTitle">
          <span class="heroTitle__row">
            <span class="${heroClass}">Qatar Bitcoin</span>
          </span>
          <span class="heroTitle__row">
            <span class="${heroClass} ${config.hero === 'gradient' ? 'gradClip gradGreenCyan' : ''}">Strategic Reserve</span>
          </span>
        </h1>
      `;
    }

    function renderComponentsPreview() {
      if (config.components === 'minimal') {
        return `
          <div style="display:flex; gap:12px; flex-wrap:wrap; margin-bottom:var(--ds-space-6);">
            <button class="ds-btn ds-btn--primary">Primary</button>
            <button class="ds-btn ds-btn--secondary">Secondary</button>
          </div>
          <div class="ds-card" style="max-width:400px;">
            <h3>Card Example</h3>
            <p>Contenu de la carte avec texte descriptif.</p>
          </div>
        `;
      } else if (config.components === 'finance') {
        return `
          <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:16px; margin-bottom:var(--ds-space-8);">
            <div class="ds-kpi">
              <div class="ds-kpi__label">Hashrate</div>
              <div class="ds-kpi__value">5.98 EH/s</div>
              <div class="ds-kpi__meta">MAJ 10:32 UTC</div>
            </div>
            <div class="ds-kpi">
              <div class="ds-kpi__label">Puissance</div>
              <div class="ds-kpi__value ds-kpi__value--accent">87.7 MW</div>
              <div class="ds-kpi__meta">Nominal</div>
            </div>
          </div>
          <table class="ds-table" style="max-width:600px;">
            <thead>
              <tr>
                <th>Poste</th>
                <th class="is-num">USD</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>CAPEX – Mineurs</td>
                <td class="is-num">80,000,000</td>
              </tr>
              <tr>
                <td>OPEX – Énergie</td>
                <td class="is-num">12,400,000</td>
              </tr>
            </tbody>
          </table>
        `;
      } else {
        // Full
        return `
          <div style="display:flex; gap:12px; flex-wrap:wrap; margin-bottom:var(--ds-space-6);">
            <button class="ds-btn ds-btn--primary">Primary</button>
            <button class="ds-btn ds-btn--secondary">Secondary</button>
            <button class="ds-btn ds-btn--pill ds-btn--primary">Pill →</button>
          </div>

          <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:16px; margin-bottom:var(--ds-space-8);">
            <div class="ds-kpi">
              <div class="ds-kpi__label">Hashrate</div>
              <div class="ds-kpi__value">5.98 EH/s</div>
              <div class="ds-kpi__meta">MAJ 10:32 UTC</div>
            </div>
            <div class="ds-kpi">
              <div class="ds-kpi__label">Puissance</div>
              <div class="ds-kpi__value ds-kpi__value--accent">87.7 MW</div>
              <div class="ds-kpi__meta">Nominal</div>
            </div>
          </div>

          <div class="ds-card" style="margin-bottom:var(--ds-space-6); max-width:500px;">
            <h3>Card Example</h3>
            <p>Contenu de la carte avec texte descriptif.</p>
          </div>

          <div class="ds-panel-dark" style="max-width:400px;">
            <div class="ds-panel-dark__title">Panneau exploitation</div>
            <div class="ds-panel-dark__line">
              <div class="ds-panel-dark__key">Temp. entrée</div>
              <div class="ds-panel-dark__value">24.6°C</div>
            </div>
            <div class="ds-panel-dark__line">
              <div class="ds-panel-dark__key">Statut</div>
              <div class="ds-panel-dark__value">OK</div>
            </div>
          </div>
        `;
      }
    }

    function applyColorTheme(theme) {
      const root = document.documentElement;
      
      if (theme === 'dark-blue') {
        root.style.setProperty('--ds-bg-canvas', '#0A0E17');
        root.style.setProperty('--ds-bg-surface-1', '#131820');
        root.style.setProperty('--ds-green-500', '#22A7F0');
        root.style.setProperty('--ds-green-300', '#6FD5FF');
      } else if (theme === 'dark-warm') {
        root.style.setProperty('--ds-bg-canvas', '#0E0C0B');
        root.style.setProperty('--ds-bg-surface-1', '#1A1714');
        root.style.setProperty('--ds-green-500', '#D4A574');
        root.style.setProperty('--ds-green-300', '#F0D4A0');
      } else {
        // dark-default (reset)
        root.style.setProperty('--ds-bg-canvas', '#0B0D0E');
        root.style.setProperty('--ds-bg-surface-1', '#121518');
        root.style.setProperty('--ds-green-500', '#18A957');
        root.style.setProperty('--ds-green-300', '#6FE3A5');
      }
    }

    // === PREVIEW MODE ===
    function setPreviewMode(mode) {
      document.querySelectorAll('.mode-btn').forEach(btn => {
        btn.classList.remove('is-active');
        if (btn.dataset.mode === mode) {
          btn.classList.add('is-active');
        }
      });

      const preview = document.getElementById('previewContent');
      if (mode === 'mobile') {
        preview.style.maxWidth = '480px';
        preview.style.margin = '0 auto';
      } else if (mode === 'tablet') {
        preview.style.maxWidth = '768px';
        preview.style.margin = '0 auto';
      } else {
        preview.style.maxWidth = 'none';
        preview.style.margin = '0';
      }
    }

    // === STORAGE ===
    function saveConfig() {
      localStorage.setItem('ds-builder-config', JSON.stringify(config));
    }

    function loadConfig() {
      const saved = localStorage.getItem('ds-builder-config');
      if (saved) {
        Object.assign(config, JSON.parse(saved));
      }
    }

    function resetBuilder() {
      if (confirm('Réinitialiser toute la configuration ?')) {
        localStorage.removeItem('ds-builder-config');
        location.reload();
      }
    }

    // === EXPORT ===
    function exportDesign() {
      const designData = {
        version: '1.0.0',
        config: config,
        timestamp: new Date().toISOString()
      };
      
      const blob = new Blob([JSON.stringify(designData, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'design-system-config.json';
      a.click();
      URL.revokeObjectURL(url);

      alert('✅ Configuration exportée ! Vous pouvez maintenant générer les fichiers CSS/HTML avec cette config.');
    }
  </script>
</body>
</html>





